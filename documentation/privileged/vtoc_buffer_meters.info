02/28/85 vtoc_buffer_meters

Syntax as a command:  vtoc_buffer_meters {-control_arg}


Function:  provides information about the utilization of volume table
of contents (VTOC) buffers.


Control arguments:
-report_reset, -rr
   generates a full report and then performs the reset operation.
-reset, -rs
   resets the metering interval for the invoking process so that the
   interval begins at the last call with -reset specified.  If -reset
   has never been given in a process, it is equivalent to having been
   specified at system initialization time.


Access required:  This command requires access to phcs_ or
metering_gate_.


Notes:  If the vtoc_buffer_meters command is given with no control
argument, it prints a full report.

The following are brief descriptions of the metering variables printed
out by the vtoc_buffer_meters command.

The first section of the output (labeled "Routine") displays the number
of calls to VTOC buffer management routines.  In each of these, the
data is presented as number of calls and as average time between calls
(ATB).  The routines included are the following:
get_vtoce
   called to read a VTOC entry, waiting for the I/O if the desired
   VTOCE entry is not already in a VTOC buffer.


put_vtoce
   called to write a VTOC entry without waiting for the I/O to
   complete.
alloc_and_put_vtoce
   called to obtain a free VTOC entry, read the VTOC entry, and write
   it back to disk.
free_vtoce
   called to return a VTOC entry to the free pool after nulling it and
   writing the nulled entry to disk.
await_vtoce
   called to await the completion of a VTOC write I/O generated by a
   previous call (e.g., to put_vtoce).


GET_BUFFERS
   an internal routine to obtain a VTOC buffer for a specified VTOC
   entry.  It first checks whether a buffer is already assigned to the
   VTOC entry (if so, this is considered a "Hit").  If a buffer is not
   assigned, the routine selects one for the VTOC entry.
WAIT
   an internal procedure to wait for completion of all I/Os for a given
   VTOC buffer.  "TC Waits" are the number of times it was necessary to
   relinquish the CPU to wait for I/O completion.


The next section of the output (labeled "Buffer Allocation") displays
data on the performance of the buffer selection algorithm (the routine
GET_BUFFERS).
Steps
   is the number of times a buffer was examined by the selection
   algorithm.
Skips
   is the number of times a buffer was skipped by the selection
   algorithm.  This is refined by the reason for the skip, as follows:

   os - an I/O was in progress for the buffer.


   hot - the buffer contained a VTOC entry that could not be written to
   disk because of irrecoverable write errors.

   wait - some process was waiting for completion of I/O activity to
   this buffer.

The last section of the output (labelled "Disk I/Os") lists the number
of disk reads and writes to the VTOC.
