08/21/2018 backup_dump

Syntax as a command:  backup_dump path -control_args


Function:  either dumps a single segment, directory, or subtree or uses
a dump control file to dump a set of segments, directories and
subtrees.  It is one of the commands used to control hierarchy dumping
of storage system segments and directories to magnetic tape.  The other
commands are:

      catchup_dump
      complete_dump
      end_dump
      start_dump
      wakeup_dump


The backup_dump command is the most general of all the hierarchy
dumping commands.  It is called by the start_dump, catchup_dump and
complete_dump commands to perform the actual dumping, after they have
set certain perprocess static switches.  In addition, you can use
various control arguments to make the backup_dump command imitate the
kind of dumping done by the start_dump, catchup_dump and complete_dump
commands.

The backup_dump command allows cross dumping, a feature not allowed by
the other hierarchy dumping commands.  That is, it allows a specified
segment, directory or subtree to be dumped to tape and recorded on the
tape as coming from a different location in the hierarchy.


You should note that argument processing for all of the hierarchy
backup commands is performed by a common argument processing procedure.
The values of all arguments are remembered in static storage and remain
in effect for the life of the process, unless changed by arguments
given in subsequent invocations of backup commands.  It should also be
noted that the dumping commands and the reloading/retrieving commands
are all part of the same hierarchy backup system, and argument values
set by the dumping commands remain in effect for the
reloading/retrieving commands and vice versa, unless overridden.
However, dumping and reloading cannot be done in the same process; use
the new_proc command between dumping and reloading.  See "Notes on
Default Arguments" below.


Arguments:
path
   is the absolute pathname of the segment, directory or subtree to be
   dumped.


Control arguments:
-all
   causes all directory entries (in the specified subtree) to be
   dumped, regardless of their dates modified or dates dumped.  This
   argument overrides a previously given -dtd control argument or DATE
   argument.  This is the default.
-brief_map, -bfmap
   creates a map file that lists the processed entries.
-control path
   indicates that path is the pathname of a dump control file.  The
   suffix "dump" is assumed.  For example, "-control sys_dirs"
   specifies a control file named sys_dirs.dump, in the working
   directory.  See "Notes on Format of a Dump Control File" below.


-debug
   disables those phcs_ and hphcs_ calls that deactivate dumped
   segments and set quotas.  This allows nonprivileged users to use
   backup_dump to save copies of their hierarchies on tape.
-destination STR, -ds STR
   specifies a destination for printing maps and error files.  The
   default is "incremental" for maps and "error file" for error files.
-dtd
   tests and dumps each segment only if the segment or its branch has
   been modified since the last time it was dumped.
-error_of
   writes error messages into a file rather than online.  The name of
   the error file is printed when the first error is encountered.  This
   is the default.


-error_on
   writes error messages on the user's terminal.
-header STR, -he STR
   specifies a heading for dprinting maps and error files.
-hold
   leaves the current hierarchy dump tape or tapes mounted and inhibits
   rewinding after the current hierarchy dump cycle is completed.
-map
   writes a list of the segments and directories processed into a file.
   This is the default.
-nodebug
   enables hphcs_ calls to set quotas and the transparency switches.
   This is the default.


-nohold
   rewinds and unloads the hierarchy dump tape or tapes at the end of
   the current dump pass.  This is the default.
-nomap
   inhibits listing of the names of processed segments and directories
   and turns the tape switch on (see -tape below).
-nooutput
   inhibits writing hierarchy dump information even if the tape switch
   is on.  This is used for a test run or debugging.
-noprimary, -npri
   uses each pathname as given.  The default is -primary.
-notape
   inhibits writing of a hierarchy tape.  This argument also causes a
   map to be created even if it was previously inhibited.  (See -map
   above.)


-only
   indicates that only the requested segment or directory and its
   branch are to be dumped.  This is the opposite of -sweep.
-operator STR
   indicates that STR is the user's name or initials (up to 16
   characters in length).
-output
   writes hierarchy dump information onto the tape if the tape switch
   is on.  This is the default.
-primary, -pr
   replaces all directory names in each pathname with the primary
   names.  This is the default.
-pvname STR
   indicates that segments and directories may only be dumped if they
   reside on the physical volume specified by STR.


-request_type STR, -rqt STR
   specifies an output request type for printing maps and error files.
   Available request types can be listed by using the
   print_request_types command.  The default is
   "printer."
-sweep
   indicates that the whole subtree beginning with the given directory
   is to be dumped, subject to the criteria of the -dtd control
   argument or the DATE argument if either has been invoked.  This is
   the default.
-tape
   allows writing of a tape.  This is the default.
-tapes N
   indicates that N is the number of output tape copies to be made
   where N can be either 1 or 2.  The default is 1.


-volume_pool path, -vp path
   indicates that the specified volume pool should be used to provide
   automated selection of tapes to use for dumping. See the
   manage_volume_pool (mvp) command for help on managing volume
   pools.
-no_volume_pool, -no_vp
   disables use of a volume pool for automatic tape selection.
-1tape
   sets the number of tape copies to 1 as an alternative to the -tapes
   argument.
-2tapes
   sets the number of tape copies to 2 as an alternative to the -tapes
   argument.


DATE
   an argument beginning with a character other than "-" or ">" is
   assumed to be a date, in a format acceptable to the
   convert_date_to_binary_ subroutine.  If the argument can be
   converted to a date, then only segments and directories modified
   after that date are dumped.


Notes on default arguments:  The values of arguments given to any of
the hierarchy backup commands are remembered in static storage and
remain in effect for the life of the process, unless explicitly changed
during the invocation of a subsequent backup command.


The following defaults are in effect for the dumper before any backup
commands are given; they are not, however, reset to these values at the
start of each backup command, except as noted.

   -all
   -contin
   -error_of
   -map
   -nodebug
   -nohold
   -output
   -primary
   -sweep
   -tape


The following defaults are set automatically at the time the respective
commands are executed:

      catchup_dump
           -tape
            (default date yesterday at midnight)

      complete_dump
           -all
           -tape

      start_dump
           -dtd
           -hold


           -tape
           -wakeup 60



Notes on format of a dump control file:  The control file specified by
"-control path" is an ASCII segment containing absolute pathnames of
entries (segments, MSFs, and directory subtrees) to be dumped, each on
a separate line.  Cross-dumping is specified by "=new_path" following a
pathname, with no intervening spaces, where new_path is the pathname of
the new parent directory if the string contains >'s; otherwise, it is a
new entryname to replace the entryname portion of the pathname dumped.
The entry is placed on the tape as if its pathname were the resulting
new pathname.
